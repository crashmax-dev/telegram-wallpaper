!function(t,i){if("object"==typeof exports&&"object"==typeof module)module.exports=i();else if("function"==typeof define&&define.amd)define([],i);else{var s=i();for(var e in s)("object"==typeof exports?exports:t)[e]=s[e]}}(this,(function(){return(()=>{"use strict";var t={};return(()=>{var i=t;Object.defineProperty(i,"__esModule",{value:!0}),i.TWallpaper=void 0;var s=[0,.25,.5,.75,1,1.5,2,2.5,3,3.5,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,18.3,18.6,18.9,19.2,19.5,19.8,20.1,20.4,20.7,21,21.3,21.6,21.9,22.2,22.5,22.8,23.1,23.4,23.7,24,24.3,24.6,24.9,25.2,25.5,25.8,26.1,26.3,26.4,26.5,26.6,26.7,26.8,26.9,27],e=[{x:.8,y:.1},{x:.6,y:.2},{x:.35,y:.25},{x:.25,y:.6},{x:.2,y:.9},{x:.4,y:.8},{x:.65,y:.75},{x:.75,y:.4}];i.TWallpaper=class{constructor(t,i){this.width=50,this.height=50,this.phase=0,this.tail=0,this.scrollTails=50,this.scrollDelta=0,this.scrollTicking=!1,this.frames=[],this.rgb=[],this.curve=s,this.positions=e,this.phases=e.length,this.init(Object.assign({container:t},i))}hexToRgb(t){var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?{r:parseInt(i[1],16),g:parseInt(i[2],16),b:parseInt(i[3],16)}:null}getPositions(t){for(var i=[...this.positions];t>0;)i.push(i.shift()),t--;for(var s=[],e=0;e<i.length;e+=2)s.push(i[e]);return s}curPosition(t,i){i%=this.tails;var s=this.getPositions(t%this.phases);if(i){var e=this.getPositions(++t%this.phases),a=(e[0].x-s[0].x)/this.tails,h=(e[0].y-s[0].y)/this.tails,r=(e[1].x-s[1].x)/this.tails,n=(e[1].y-s[1].y)/this.tails,l=(e[2].x-s[2].x)/this.tails,o=(e[2].y-s[2].y)/this.tails,c=(e[3].x-s[3].x)/this.tails,d=(e[3].y-s[3].y)/this.tails;return[{x:s[0].x+a*i,y:s[0].y+h*i},{x:s[1].x+r*i,y:s[1].y+n*i},{x:s[2].x+l*i,y:s[2].y+o*i},{x:s[3].x+c*i,y:s[3].y+d*i}]}return s}changeTail(t){for(this.tail+=t;this.tail>=this.tails;)this.tail-=this.tails,this.phase++,this.phase>=this.phases&&(this.phase-=this.phases);for(;this.tail<0;)this.tail+=this.tails,this.phase--,this.phase<0&&(this.phase+=this.phases)}onWheel(t){this.interval||(this.scrollDelta+=t.deltaY,this.scrollTicking||(requestAnimationFrame((()=>this.drawOnWheel())),this.scrollTicking=!0))}drawOnWheel(){var t=this.scrollDelta/this.scrollTails;if(this.scrollDelta%=this.scrollTails,t=t>0?Math.floor(t):Math.ceil(t)){this.changeTail(t);var i=this.curPosition(this.phase,this.tail);this.drawGradient(i)}this.scrollTicking=!1}drawNextPositionAnimated(t){if(this.frames.length>0){var i=this.frames.shift();this.drawImageData(i)}else clearInterval(this.interval),this.interval=null,t&&t()}getGradientImageData(t){for(var i=this.hctx.createImageData(this.width,this.height),s=i.data,e=0,a=0;a<this.height;a++)for(var h=a/this.height-.5,r=h*h,n=0;n<this.width;n++){for(var l=n/this.width-.5,o=.35*Math.sqrt(l*l+r),c=o*o*.8*8,d=Math.sin(c),m=Math.cos(c),p=Math.max(0,Math.min(1,.5+l*m-h*d)),v=Math.max(0,Math.min(1,.5+l*d+h*m)),u=0,x=0,g=0,y=0,f=0;f<this.rgb.length;f++){var w=p-t[f].x,P=v-t[f].y,b=Math.max(0,.9-Math.sqrt(w*w+P*P));u+=b*=b*b*b,x+=b*this.rgb[f].r/255,g+=b*this.rgb[f].g/255,y+=b*this.rgb[f].b/255}s[e++]=x/u*255,s[e++]=g/u*255,s[e++]=y/u*255,s[e++]=255}return i}drawImageData(t){this.hctx.putImageData(t,0,0),this.ctx.drawImage(this.hc,0,0,this.width,this.height)}drawGradient(t){this.drawImageData(this.getGradientImageData(t))}requestAnimate(){this.raf=requestAnimationFrame((()=>this.doAnimate()))}doAnimate(){var t=+Date.now();if(t-this.timestamp<this.frametime)return this.requestAnimate();this.timestamp=t,this.changeTail(1);var i=this.curPosition(this.phase,this.tail);this.drawGradient(i),this.requestAnimate()}init(t){var{fps:i,tails:s,colors:e,pattern:a,animate:h,container:r,scrollAnimate:n}=t;if(this.container=null!=r?r:this.container,!this.container||!e.length)throw new Error("Container or colors do not exist");this.dispose(),this.hc||(this.hc=document.createElement("canvas"),this.hc.width=this.width,this.hc.height=this.height,this.hctx=this.hc.getContext("2d")),this.canvas=document.createElement("canvas"),this.canvas.classList.add("tw-canvas"),this.canvas.width=this.width,this.canvas.height=this.height,this.ctx=this.canvas.getContext("2d"),this.container.appendChild(this.canvas),a&&(this.pattern=document.createElement("div"),this.pattern.classList.add("tw-pattern"),this.updatePattern(a),this.container.appendChild(this.pattern)),this.animate(h),this.updateTails(s),this.updateColors(e),this.updateFrametime(i),this.scrollAnimate(n)}dispose(){var t;this.hc&&(clearInterval(this.interval),this.interval=null,this.animate(!1),this.canvas.remove(),null===(t=this.pattern)||void 0===t||t.remove(),this.hc.remove(),this.frames=[])}updateTails(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:90;t>0&&(this.tails=t)}updateFrametime(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:30;this.frametime=1e3/t}updatePattern(t){if(this.pattern&&this.container){var{mask:i,blur:s,size:e,image:a,opacity:h,background:r}=t,{style:n}=this.container;n.setProperty("--tw-size",null!=e?e:"auto"),n.setProperty("--tw-opacity","".concat(null!=h?h:.5)),n.setProperty("--tw-blur","".concat(null!=s?s:0,"px")),n.setProperty("--tw-background",null!=r?r:"#000"),a?n.setProperty("--tw-image","url(".concat(a,")")):n.removeProperty("--tw-image"),i?this.canvas.classList.add("tw-mask"):this.canvas.classList.remove("tw-mask")}}updateColors(t){var i=t.reduce(((t,i)=>{var s=this.hexToRgb(i);return s&&t.push(s),t}),[]);if(!(i.length>1&&i.length<5))throw new Error("Required from 1-4 hex colors");this.rgb=i}toNextPosition(t){clearInterval(this.interval),this.animate(!1),this.frames=[];var i=this.getPositions(this.phase%this.phases);this.phase++;for(var s=this.getPositions(this.phase%this.phases),e=27,a=(s[0].x-i[0].x)/e,h=(s[0].y-i[0].y)/e,r=(s[1].x-i[1].x)/e,n=(s[1].y-i[1].y)/e,l=(s[2].x-i[2].x)/e,o=(s[2].y-i[2].y)/e,c=(s[3].x-i[3].x)/e,d=(s[3].y-i[3].y)/e,m=0;m<this.curve.length;m++){var p=[{x:i[0].x+a*this.curve[m],y:i[0].y+h*this.curve[m]},{x:i[1].x+r*this.curve[m],y:i[1].y+n*this.curve[m]},{x:i[2].x+l*this.curve[m],y:i[2].y+o*this.curve[m]},{x:i[3].x+c*this.curve[m],y:i[3].y+d*this.curve[m]}];this.frames.push(this.getGradientImageData(p))}this.interval=setInterval((()=>{this.drawNextPositionAnimated(t)}),this.frametime)}animate(){!(arguments.length>0&&void 0!==arguments[0])||arguments[0]?this.doAnimate():this.raf&&(cancelAnimationFrame(this.raf),this.raf=null)}scrollAnimate(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];document.onwheel=t?t=>this.onWheel(t):null}}})(),t})()}));